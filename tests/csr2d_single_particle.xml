<?xml version="1.0"?>
<teufel description="Coherent synchrotron radiation from a homogeneous dipole"
    author="Ulf Lehnert 29.6.2020">
    <calc print="beam energy [eV] = " var="E_beam" eq="50.0e6" />
    <calc print="gamma = " var="gamma" eq="E_beam/_mec2"/>
    <calc print="beta*gamma = " var="betagamma" eq="sqrt(gamma*gamma-1.0)"/>
    <calc print="beta = " var="beta" eq="sqrt(1.0-1.0/(gamma*gamma))"/>
    <calc print="charge [nC] = " var="charge" eq="-1.0" />
    <calc print="r [m] = " var="radius" eq="0.3"/>
    <lattice>
        <background>
            <!-- compute field setting from bending radius -->
            <calc print="B*r [T m] = " var="Brho" eq="betagamma*_mec2/_c"/>
            <calc print="B [T] = " var="By" eq="Brho/radius"/>
            <B x="0.0" y="By" z="0.0" />
        </background>
    </lattice>
    <beam>
        <!-- a single particle moving in the x-z plane crosses the origin at half-way -->
        <particle gamma="gamma" charge="1.0e-9*charge" cmr="-1.0" >
            <position x="radius*(1.0-1.0/sqrt(2))" y="0.0" z="-radius/sqrt(2)" />
            <momentum x="-1.0/sqrt(2)" y="0.0" z="1.0/sqrt(2)" />
            <trajectory file="csr2d_trajectory.hdf5"/>
        </particle>
    </beam>
    <calc print="tracking length [m] = " var="total_L" eq="radius*_pi/2.0" />
    <calc print="tracking total time [s] = " var="total_t" eq="total_L/_c" />
    <calc print="dt = " var="dt" eq="total_t/1000" />
    <tracking method="Vay" delta_t="dt" n="1000" >
        <csr2d N_long="20" N_trans="10">
            <longitudinal x="0.0" y="0.0" z="1.0"/>
            <transversal x="1.0" y="0.0" z="0.0"/>
            <log file="csr2d_interaction_fields.hdf5" step="100" />
        </csr2d>
    </tracking>
    <observer>
        <snapshot file="csr2d_snap_499.h5">
            <time t0="499*dt" />
            <position x="0.0" y="0.0" z="0.0" />
            <hpitch x="0.000050" y="0.0" z="0.0" n="101" />
            <vpitch x="0.0" y="0.0" z="0.000010" n="251" />
        </snapshot>
        <snapshot file="csr2d_snap_500.h5">
            <time t0="500*dt" />
            <position x="0.0" y="0.0" z="0.0" />
            <hpitch x="0.000050" y="0.0" z="0.0" n="101" />
            <vpitch x="0.0" y="0.0" z="0.000010" n="251" />
        </snapshot>
        <snapshot file="csr2d_snap_501.h5">
            <time t0="501*dt" />
            <position x="0.0" y="0.0" z="0.0" />
            <hpitch x="0.000050" y="0.0" z="0.0" n="101" />
            <vpitch x="0.0" y="0.0" z="0.000005" n="251" />
        </snapshot>
    </observer>
</teufel>
